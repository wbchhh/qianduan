<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/index.css">
    <script src="js/jquery.min.js"></script>
    <script>
        // è·å–æ•°ç»„ä¸­æœ€å°å€¼ä»¥åŠç´¢å¼•å€¼çš„å‡½æ•°
        function getArrayMin( arr ){
            // å®šä¹‰ä¸€ä¸ªç©ºå¯¹è±¡
            var min = {};
            // å‡è®¾æ•°ç»„æœ€å°å€¼çš„ç´¢å¼•å€¼
            min.index = 0;
            // å‡è®¾æ•°ç»„æœ€å°å€¼
            min.value = arr[0];

            for(var i = 1 ; i< arr.length; i++ ){
                if( min.value > arr[i] ){
                    min.value = arr[i];
                    min.index = i;
                }
            }
            return min;
        }

        // è·å–æ•°ç»„ä¸­æœ€å¤§å€¼ä»¥åŠç´¢å¼•å€¼çš„å‡½æ•°
        function getArrayMax( arr ){
            // å®šä¹‰ä¸€ä¸ªç©ºå¯¹è±¡
            var max = {};
            // å‡è®¾æ•°ç»„æœ€å°å€¼çš„ç´¢å¼•å€¼
            max.index = 0;
            // å‡è®¾æ•°ç»„æœ€å°å€¼
            max.value = arr[0];

            for(var i = 1 ; i< arr.length; i++ ){
                if( max.value < arr[i] ){
                    max.value = arr[i];
                    max.index = i;
                }
            }
            return max;
        }


        $(function(){
            // 1. å£°æ˜ä¸€ä¸ªå˜é‡,ä¿å­˜æ¯ä¸ªå›¾ç‰‡ç›’å­é¡¹ç›®çš„é—´è·è·ç¦»
            var gap = 18;
            // 2. æ‰¾åˆ°å¤§ç›’å­å…ƒç´ ä»¥åŠæ‰¾åˆ°å›¾ç‰‡ç›’å­å…ƒç´ 
            var box = $(".box");
            var item = $(".box .item");
            // 3. ç®—å‡ºç€‘å¸ƒæµçš„åˆ—æ•°(æ¯ä¸€è¡Œèƒ½æ”¾å‡ å¼ å›¾ç‰‡) ç”¨å¤§ç›’å­å…ƒç´ çš„å®½åº¦/å›¾ç‰‡çš„å…ƒç´ 
            var boxWidth = box.width();
            var itemWidth = item.width();
            var column = Math.floor( boxWidth/itemWidth );
            // 5. ä½¿ç”¨æ•°ç»„ä¿å­˜å½“å‰æ¯åˆ—å›¾ç‰‡ç›’å­çš„é«˜åº¦å€¼,æ‰¾å‡ºé«˜åº¦æœ€å°é‚£ä¸€åˆ—çš„ä½ç½®,ä»¥åŠè¿™ä¸€åˆ—çš„é«˜åº¦å€¼
            // è¿™ä¸ªæ•°ç»„ä¿å­˜æ¯ä¸€åˆ—çš„é«˜åº¦å€¼
            var arrHeight = [];
            // 4. éå†æ¯ä¸ªå›¾ç‰‡ç›’å­,å…ˆè®¾ç½®ç¬¬ä¸€è¡Œæ¯ä¸ªå›¾ç‰‡ç›’å­çš„topå’Œleftå€¼
            item.each(function(index,element){
                if( index < column ){// å…ˆç¡®å®šç¬¬ä¸€è¡Œå›¾ç‰‡ç›’å­çš„æ’åˆ—ä½ç½®
                    $(element).css({
                        top:0,
                        left: (itemWidth+gap)*index
                    });
                    // æŠŠç¬¬ä¸€ä¸ªæ¯ä¸ªå›¾ç‰‡ç›’å­çš„é«˜åº¦æ·»åŠ åˆ°æ•°ç»„ä¸­
                    arrHeight.push( $(element).height() );
                }else{// ç¬¬ä¸€è¡Œä¹‹å¤–
                    var min_value = getArrayMin( arrHeight ).value;
                    var min_index = getArrayMin( arrHeight ).index;
                    // 6. æ¥ç€æ‘†ç¬¬äºŒè¡Œç¬¬ä¸€ä¸ªå›¾ç‰‡ç›’å­,éœ€è¦æ‘†åœ¨ç¬¬ä¸€è¡Œé«˜åº¦æœ€å°çš„å›¾ç‰‡ç›’å­ä¸‹é¢,ç„¶åæ¥ç€æ‰¾å‡ºå½“å‰å‡ åˆ—ä¸­,é«˜åº¦æœ€å°çš„é‚£ä¸€åˆ—,ç»§ç»­æ”¾ç¬¬äºŒè¡Œç¬¬äºŒä¸ªå›¾ç‰‡,ä¾æ¬¡ç±»æ¨ç»§ç»­æ‘†æ”¾åç»­å›¾ç‰‡
                    $(element).css({
                        top: min_value + gap ,
                        left: (itemWidth+gap)*min_index
                    });

                    // æ›´æ–°æœ€å°åˆ—çš„å€¼
                    arrHeight[min_index] += $(element).height() + gap;
                }
            });
            // 7. ç­‰æ‰€æœ‰å›¾ç‰‡æ‘†æ”¾å®Œæ¯•ä»¥å,æ‰¾å‡ºé«˜åº¦æœ€é«˜çš„é‚£ä¸€åˆ—,ä½œä¸ºå¤§ç›’å­çš„é«˜åº¦,è¿™æ ·å¤§ç›’å­åç»­å†…å®¹æ‰èƒ½æ­£å¸¸æ˜¾ç¤º
            var max_value = getArrayMax( arrHeight ).value;
            box.css("height", max_value );

            // å®šä¹‰æ•°æ®
            var itemData = [
                {
                    "img_num":"01",
                    "title":"æ‹¥æœ‰ä¸€å°å®¾åˆ©GTï¼Œå¦‚ä½•æ‹ï¼Œæ‰ä¸ä¼šè¢«è¯´ç‚«å¯Œï¼Ÿ",
                    "uname":"é‡‘è‹±ç„•",
                    "num":102
                },{
                    "img_num":"02",
                    "title":"ğŸ›æ¸…å‡‰ä¸€å¤ï¼Œå®å®ç”¨çš„è¿™äº›ä¸œè¥¿ä½ ğŸ‰çŸ¥é“â€¦",
                    "uname":"æˆ‘æ˜¯ç‰›æ²¹æœå‘€å‘€",
                    "num":112
                },{
                    "img_num":"03",
                    "title":"è¿™äº›è¶…ç«çš„åŠ¨æ¼«å°è¯ä½ ç»å¯¹éƒ½æœ‰å¬è¿‡",
                    "uname":"å­¦è¯´æ—¥è¯­",
                    "num":305
                },{
                    "img_num":"04",
                    "title":"é«˜æ®µä½çš„ç§‘å­¦è‚²å„¿ç†å¿µï¼åŸæ¥æ˜¯å®ƒï½",
                    "uname":"å°è¿·å§å„¿æ˜¯è±†è±†é¾™",
                    "num":101
                },{
                    "img_num":"05",
                    "title":"æ²¡æƒ³åˆ°å› ä¸ºå©´å„¿æ¨è½¦ï¼Œæˆ‘å±…ç„¶è¢«å­©å­çˆ¸å¤¸äº†â€¦",
                    "uname":"æˆ‘æ˜¯ç‰›æ²¹æœå‘€å‘€",
                    "num":164
                },{
                    "img_num":"06",
                    "title":"æ—¥å¸¸vlogï½œå¦ˆå¦ˆã€åšä¸»ï¼Œæ¯å¤©èº«ä»½è½¬æ¢",
                    "uname":"æœ¨å¤•_æœ¨",
                    "num":976
                },{
                    "img_num":"07",
                    "title":"è¿™ä¸ªé£Ÿè°±æ‘†æ‘Šèƒ½ä¸èƒ½èµšåˆ°å­¦è´¹å¤§å®¶å¸®å¿™å‚è€ƒä¸€ä¸‹ğŸ˜‚",
                    "uname":"å½­é›¨è·baby",
                    "num":1373
                },{
                    "img_num":"08",
                    "title":"å’Œæ²¹æ±¡èŸ‘è‚say byebyeï½œå¨æˆ¿æ¸…æ´å¥½ç‰©åˆ†äº«",
                    "uname":"Cikoe",
                    "num":60
                },{
                    "img_num":"09",
                    "title":"ä¸Šè¡—è¶…æƒ¹çœ¼å®å…‰MINI EVï¼Œå¸‚åŒºä»£æ­¥è½¦æ€§ä»·é«˜",
                    "uname":"ä¸€é¢—å°ç”œæ¬£",
                    "num":80
                },{
                    "img_num":"10",
                    "title":"ğŸ“¢å¿«å¼€å­¦äº†ï¼ï¼ï¼å†ä¸å‡†å¤‡å°±æ™šäº†âœ…",
                    "uname":"æˆ‘å«å°è±†æµ†",
                    "num":261
                },{
                    "img_num":"11",
                    "title":"è†ç”°æ¢åº—ï½œæ—¶é›¾ç¾æœ¯é¦†",
                    "uname":"iamlittley",
                    "num":43
                },{
                    "img_num":"12",
                    "title":"å‚åŠ æ´»åŠ¨é‡åˆ°å–œæ¬¢åšä¸» ç¬é—´å˜æˆå°è¿·å¦¹",
                    "uname":"Chiliå¾è¾£å„¿",
                    "num":112
                },{
                    "img_num":"13",
                    "title":"å­¦ä¹ å¹²è´§ğŸ“–å„ç§‘ç¬”è®°è®°ä»€ä¹ˆï¼Œä¸çœ‹åæ‚”âœ“ byebyeï½œå¨æˆ¿æ¸…æ´å¥½ç‰©åˆ†äº«",
                    "uname":"è´ºå«å…½",
                    "num":1687
                },{
                    "img_num":"14",
                    "title":"ç™½è‰²çš„å·å´H2ä½ è§è¿‡å— EVï¼Œå¸‚åŒºä»£æ­¥è½¦æ€§ä»·é«˜",
                    "uname":"æœºè½¦ç›®å½•",
                    "num":146
                },{
                    "img_num":"15",
                    "title":"My MelodyğŸ€ï½œç¾ä¹è’‚å°‘å¥³å¿ƒç”Ÿæ´»åŠ©æ‰‹",
                    "uname":"é¸­é¸­åƒé¥­å•¦",
                    "num":2148
                },{
                    "img_num":"16",
                    "title":"å¥³ç”Ÿå¿…å­¦ç´§æ€¥ç˜¦èº«æ³•â€¼ï¸ä¸€å‘¨å°±èƒ½ç˜¦å…«æ–¤âœ”ï¸",
                    "uname":"æ¡ƒæ¡ƒçˆ±åƒæ¡ƒ",
                    "num":910
                },{
                    "img_num":"17",
                    "title":"æ¢…å®¶æ™šé¥­",
                    "uname":"æ¢…ä¹‹å°æ¦­",
                    "num":129
                },{
                    "img_num":"18",
                    "title":"è¶ŠæŠ¤è‚¤è¶Šæ²¹â“åˆ†äº«æ··æ²¹ç—˜è‚Œçš„è‡ªç”¨ç»éªŒ",
                    "uname":"å®ä¸ƒä¸ƒYuki",
                    "num":84
                },{
                    "img_num":"19",
                    "title":"ã€NO.62ã€å†™ä½œè¯¾ğŸ“’â… å«å†™ä½œä¹¦å•æ•´ç†ğŸ“š",
                    "uname":"è‹æ‚ æ‰¬",
                    "num":163
                },{
                    "img_num":"20",
                    "title":"é­”éƒ½æ¢åº—ï½œèŠ‹æ³¥ç‰›å¥¶å†°æ²™â€¼ï¸å®è—ç”œå“åº—â€¼ï¸",
                    "uname":"Angelaå½±",
                    "num":869
                }
            ]
            // æŸ¥çœ‹æ›´å¤šåŠŸèƒ½
            $(".more").on("click",function(){
                if( itemData.length > 0 ){
                    // å®šä¹‰ä¸€ä¸ªæ–°çš„ç©ºæ•°ç»„
                    var newData = [];
                    for(var i = 1; i <= 5; i++){
                        // éšæœºä¸‹æ ‡
                        var index = Math.floor(Math.random()*itemData.length) ;
                        // å»åˆ°éšæœºä¸‹æ ‡å¯¹åº”çš„å…ƒç´ 
                        newData.push(  itemData[index] );
                        // ç„¶åå°†è¿™ä¸ªéšæœºå¾—åˆ°çš„å…ƒç´ ä»åŸæ•°ç»„arrä¸­å‰”é™¤
                        itemData.splice(index,1);
                    }
                    
                    // éå†æ·»åŠ å…ƒç´ 
                    $.each( newData , function( currentIndex, item ){
                        var currentNode = $(`<div class="item">
                                    <a href="#">
                                        <img src="images/pic/${item.img_num}.jpg" class="pro_img"/>
                                        <p class="title">${item.title}</p>
                                        <p class="user">
                                            <img src="images/touxiang/${item.img_num}.jpg" class="user_img"/>
                                            <span class="uname">${item.uname}</span>
                                            <span class="num">${item.num}</span>
                                        </p>
                                    </a>
                                </div>`);

                        box.append( currentNode );
                        
                        setTimeout(function(){
                        	// éšè—å…ƒç´ 
                        	currentNode.hide();
                        	// æ·¡å…¥å…ƒç´ 
                        	currentNode.fadeIn(500);
                        	
                            min_value = getArrayMin( arrHeight ).value;
                            min_index = getArrayMin( arrHeight ).index;
                            // 6. æ¥ç€æ‘†ç¬¬äºŒè¡Œç¬¬ä¸€ä¸ªå›¾ç‰‡ç›’å­,éœ€è¦æ‘†åœ¨ç¬¬ä¸€è¡Œé«˜åº¦æœ€å°çš„å›¾ç‰‡ç›’å­ä¸‹é¢,ç„¶åæ¥ç€æ‰¾å‡ºå½“å‰å‡ åˆ—ä¸­,é«˜åº¦æœ€å°çš„é‚£ä¸€ç±»,ç»§ç»­æ”¾ç¬¬äºŒè¡Œç¬¬äºŒä¸ªå›¾ç‰‡,ä¾æ¬¡ç±»æ¨ç»§ç»­æ‘†æ”¾åç»­å›¾ç‰‡
                            currentNode.css({
                                top: min_value + gap ,
                                left: (itemWidth+gap)*min_index
                            });
                            // æ›´æ–°æœ€å°åˆ—çš„å€¼
                            arrHeight[min_index] += currentNode.height() + gap;
                        },50);

                    })
                }else{
                	// è®¾ç½®å†…å®¹
                    $(this).html("æ²¡æœ‰æ›´å¤šæ•°æ®äº†~");
                    // è®¾ç½®æ ·å¼
                    $(this).css({
                        "color":"gray",
                        "cursor":"not-allowed",
                    });
                    // è§£ç»‘äº‹ä»¶
                    $(this).off("click");
                }

                setTimeout(function(){
                	// è®¾ç½®ç›’å­æœ€å¤§å€¼
                    max_value = getArrayMax( arrHeight ).value;
                    box.css("height", max_value );

                    // åŠ¨ç”»æ»šåŠ¨åˆ°åº•éƒ¨
                    $("html,body").stop().animate({scrollTop:$("html,body").prop("scrollHeight")}, 500 );

                }, 500 );

            })
        });
    </script>
</head>
<body>
    <div class="box">
        <div class="item">
            <a href="#">
                <img src="images/pic/01.jpg" class="pro_img"/>
                <p class="title">æ‹¥æœ‰ä¸€å°å®¾åˆ©GTï¼Œå¦‚ä½•æ‹ï¼Œæ‰ä¸ä¼šè¢«è¯´ç‚«å¯Œï¼Ÿ</p>
                <p class="user">
                    <img src="images/touxiang/01.jpg" class="user_img"/>
                    <span class="uname">é‡‘è‹±ç„•</span>
                    <span class="num">102</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/02.jpg" class="pro_img"/>
                <p class="title">ğŸ›æ¸…å‡‰ä¸€å¤ï¼Œå®å®ç”¨çš„è¿™äº›ä¸œè¥¿ä½ ğŸ‰çŸ¥é“â€¦</p>
                <p class="user">
                    <img src="images/touxiang/02.jpg" class="user_img"/>
                    <span class="uname">æˆ‘æ˜¯ç‰›æ²¹æœå‘€å‘€</span>
                    <span class="num">112</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/03.jpg" class="pro_img"/>
                <p class="title">è¿™äº›è¶…ç«çš„åŠ¨æ¼«å°è¯ä½ ç»å¯¹éƒ½æœ‰å¬è¿‡</p>
                <p class="user">
                    <img src="images/touxiang/03.jpg" class="user_img"/>
                    <span class="uname">å­¦è¯´æ—¥è¯­</span>
                    <span class="num">305</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/04.jpg" class="pro_img"/>
                <p class="title">é«˜æ®µä½çš„ç§‘å­¦è‚²å„¿ç†å¿µï¼åŸæ¥æ˜¯å®ƒï½</p>
                <p class="user">
                    <img src="images/touxiang/04.jpg" class="user_img"/>
                    <span class="uname">å°è¿·å§å„¿æ˜¯è±†è±†é¾™</span>
                    <span class="num">101</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/05.jpg" class="pro_img"/>
                <p class="title">æ²¡æƒ³åˆ°å› ä¸ºå©´å„¿æ¨è½¦ï¼Œæˆ‘å±…ç„¶è¢«å­©å­çˆ¸å¤¸äº†â€¦</p>
                <p class="user">
                    <img src="images/touxiang/05.jpg" class="user_img"/>
                    <span class="uname">æˆ‘æ˜¯ç‰›æ²¹æœå‘€å‘€</span>
                    <span class="num">164</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/06.jpg" class="pro_img"/>
                <p class="title">æ—¥å¸¸vlogï½œå¦ˆå¦ˆã€åšä¸»ï¼Œæ¯å¤©èº«ä»½è½¬æ¢</p>
                <p class="user">
                    <img src="images/touxiang/06.jpg" class="user_img"/>
                    <span class="uname">æœ¨å¤•_æœ¨</span>
                    <span class="num">976</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/07.jpg" class="pro_img"/>
                <p class="title">è¿™ä¸ªé£Ÿè°±æ‘†æ‘Šèƒ½ä¸èƒ½èµšåˆ°å­¦è´¹å¤§å®¶å¸®å¿™å‚è€ƒä¸€ä¸‹ğŸ˜‚</p>
                <p class="user">
                    <img src="images/touxiang/07.jpg" class="user_img"/>
                    <span class="uname">å½­é›¨è·baby</span>
                    <span class="num">1373</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/08.jpg" class="pro_img"/>
                <p class="title">å’Œæ²¹æ±¡èŸ‘è‚say byebyeï½œå¨æˆ¿æ¸…æ´å¥½ç‰©åˆ†äº«</p>
                <p class="user">
                    <img src="images/touxiang/08.jpg" class="user_img"/>
                    <span class="uname">Cikoe</span>
                    <span class="num">60</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/09.jpg" class="pro_img"/>
                <p class="title">ä¸Šè¡—è¶…æƒ¹çœ¼å®å…‰MINI EVï¼Œå¸‚åŒºä»£æ­¥è½¦æ€§ä»·é«˜</p>
                <p class="user">
                    <img src="images/touxiang/09.jpg" class="user_img"/>
                    <span class="uname">ä¸€é¢—å°ç”œæ¬£</span>
                    <span class="num">80</span>
                </p>
            </a>
        </div>
        <div class="item">
            <a href="#">
                <img src="images/pic/10.jpg" class="pro_img"/>
                <p class="title">ğŸ“¢å¿«å¼€å­¦äº†ï¼ï¼ï¼å†ä¸å‡†å¤‡å°±æ™šäº†âœ…</p>
                <p class="user">
                    <img src="images/touxiang/10.jpg" class="user_img"/>
                    <span class="uname">æˆ‘å«å°è±†æµ†</span>
                    <span class="num">261</span>
                </p>
            </a>
        </div>
    </div>

    <a href="javascript:void(0)" class="more">æŸ¥çœ‹æ›´å¤š</a>
</body>
</html>